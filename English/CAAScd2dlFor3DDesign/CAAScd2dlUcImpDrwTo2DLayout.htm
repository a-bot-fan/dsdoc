<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
<meta http-equiv="Content-Language" content="en-us" />
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<meta name="topictype" content="Uc" />
<meta name="devlang" content="idl" />
<meta name="devlang" content="idl" />
<link rel="stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css"/>
<script type="text/javascript" src="../CAADocJavaScript/DSDocTocToc.js">/* */</script>
<script type="text/javascript" src="../CAADocJavaScript/DSDocHighlight.js">/* */</script>
<script type="text/javascript" src="../CAADocJavaScript/submit.js">/* */</script>
<title>Importing a Drawing into a New 2D Layout for 3D Design</title>
<style type="text/css">
.auto-style1 {
	margin-left: 30px;
}
.auto-style2 {
	margin: auto;
}

</style>
</head>

<body onload="highlightSearchTerms();">
<table class="table1">
	<tr>
		<td class="DocHeader3">
		<table>
			<tr>
				<td class="DocHeader1" colspan="2" style="height: 10px">
				<h1>Importing a Drawing into a New 2D Layout</h1>
				</td>
			</tr>
			<tr>
				<td class="DocHeader4" colspan="2">&nbsp;</td>
			</tr>
			<tr>
				<td class="DocHeader3">
				<table class="DocHeaderIntro">
					<tr>
						<td class="Intro1">
						<p class="header"><a name="hj-top"></a>This use case 
						primarily focuses on the methodology to import a Drawing into a New 2D Layout.</p>
						<hr class="header" /></td>
					</tr>
					<tr>
						<td class="Intro2"><span class="run-in">Before you begin :</span> 
						<ul>
							<li>You should first launch CATIA and import the 
							<code>SkateDrawing.3dxml</code> file supplied in 
							folder <code>
							InstallRootFolder\CAADoc\Doc\English\CAAScd2dlFor3DDesign\samples\</code> 
							where <code>InstallRootFolder</code> is the 
							directory where the CAA CD-ROM is installed.</li>
						</ul>
						<p><span class="run-in">Where to find the macro :
						<a href="CAAScd2dlUcImpDrwTo2DLayoutSource.htm">CAAScd2dlUcImpDrwTo2DLayoutSource.htm</a></span></p>
						</td>
					</tr>
				</table>
				</td>
			</tr>
		</table>
		</td>
	</tr>
</table>
<table class="indented">
	<tr>
		<td>
		<p>This use case:</p>
		<ol>
			<li><a href="#Step1">Gets the Drawing information</a></li>
			<li><a href="#Step2">Creates the 3D Shape and its 2D Layout</a></li>
			<li><a href="#Step3">Copies the Drawing Sheets in the 2D Layout</a></li>		
		</ol>
		</td>
	</tr>
</table>
<table class="table1">
	<tr>
		<td>
		<ol class="task">
			<li>
				<p><strong><a name="Step1">Gets the Drawing information</a></strong></p>
				
				<pre class="code">
<span class="comment">' Gets the drawing Editor </span>
<span class="keyword">Dim</span> drwEditor <span class="keyword">As</span> Editor 
<span class="keyword">Set</span> drwEditor = CATIA.ActiveEditor 

<span class="comment">' Gets the drawing Root </span>
<span class="keyword">Dim</span> drwRoot <span class="keyword">As</span> DrawingRoot 
<span class="keyword">Set</span> drwRoot = drwEditor.ActiveObject 

<span class="comment">' Gets the drawing Title </span>
<span class="keyword">Dim</span> drwRepRef <span class="keyword">As</span> VPMRepReference 
<span class="keyword">Set</span> drwRepRef = drwRoot.Parent 

<span class="keyword">Dim</span> drwTitle <span class="keyword">As</span> String 
drwTitle = drwRepRef.GetAttributeValue(&quot;V_Name&quot;) 
...</pre>
			
			</li>
			<li>
				<p><strong><a name="Step2">Gets the Root Occurrence</a></strong></p>
	
				<pre class="code"> ...
<span class="comment">' Gets the PLMNewService </span>
<span class="keyword">Dim</span> oNewService <span class="keyword">As</span> PLMNewService 
<span class="keyword">Set</span> oNewService = CATIA.GetSessionService(&quot;PLMNewService&quot;) 

<span class="comment">' Creates the 3D Shape representation </span>
<span class="keyword">Dim</span> shapeEditor <span class="keyword">As</span> Editor 
oNewService.PLMCreate &quot;3DShape&quot;, shapeEditor 

<span class="comment">' Changes its Title </span>
<span class="keyword">Dim</span> shapeRepRef <span class="keyword">As</span> VPMRepReference 
<span class="keyword">Set</span> shapeRepRef = shapeEditor.ActiveObject.Parent 

shapeRepRef.SetAttributeValue &quot;V_Name&quot;, drwTitle 

<span class="comment">' Creates the 2D Layout </span>
<span class="keyword">Dim</span> shapePart <span class="keyword">As</span> Part 
<span class="keyword">Set</span> shapePart = shapeEditor.ActiveObject 

<span class="keyword">Dim</span> shapeLayRootFact <span class="keyword">As</span> Layout2DFactory 
<span class="keyword">Set</span> shapeLayRootFact = shapePart.GetItem(&quot;CATLayoutRootFactory&quot;) 

<span class="keyword">Dim</span> shapeLayRoot <span class="keyword">As</span> Layout2DRoot 
<span class="keyword">Set</span> shapeLayRoot = shapeLayRootFact.Create2DLayout(drwRoot.Standard) 
...</pre>
				<p>The 3D Shape has the same Name as the Drawing and the 2D 
				Layout has the same Standard as the Drawing.</p>
			</li>
		    <li>
				<p><strong><a name="Step3">Copies the Drawing Sheets in the 2D Layout</a></strong></p>
				<p>The UC copies each Sheet in the 2D Layout.</p>
				<pre class="code">...
<span class="keyword">For</span> i = 1 <span class="keyword">To</span> drwRoot.Sheets.Count 
  <span class="keyword">Dim</span> drwSheet <span class="keyword">As</span> DrawingSheet 
  <span class="keyword">Set</span> drwSheet = drwRoot.Sheets.Item(i) 

  <span class="comment">' Creates a new Layout Sheet </span>
  shapeLayRoot.Sheets.Add drwSheet.Name 

  <span class="comment">' Gets the Sheet Views </span>
  <span class="keyword">Dim</span> tabToImport() <span class="keyword">As</span> Variant 
  <span class="keyword">ReDim</span> tabToImport(drwSheet.Views.Count - 3) 
  <span class="keyword">For</span> j = 3 <span class="keyword">To</span> drwSheet.Views.Count 
     <span class="keyword">Set</span> tabToImport(j - 3) = drwSheet.Views.Item(j) 
  <span class="keyword">Next</span> 

  <span class="comment">' Gets the 2D Layout Services </span>
  <span class="keyword">Dim</span> layoutServices <span class="comment">' As Layout2DServices </span>
  <span class="keyword">Set</span> layoutServices = shapeLayRoot.GetItem(&quot;CATLayout2DServices&quot;) 

  <span class="comment">' Imports the Views in the 2D Layout </span>
  <span class="keyword">Dim</span> tabImported() <span class="keyword">As</span> Variant 
  <span class="keyword">ReDim</span> tabImported(drwSheet.Views.Count - 3) 
  layoutServices.ImportFromDrawing tabToImport, CatImportAll, tabImported 
<span class="keyword">Next</span> 
...</pre>
				<p>The method ImportFromDrawing copies the CATSafeArrayVariant 
				tabToImport Drawing Views into the Active 2D Layout Sheet and 
				copies the created 2D Layout Views into the CATSafeArrayVariant 
				tabImported.</p>
					<p> &nbsp;</p>
				<p> Then, removes the First 2D Layout Sheet.</p>
					<pre class="code">
shapeLayRoot.Sheets.Remove 1 </pre>					
					<p>The first 2D Layout Sheet is created automaticaly with the 2D Layout and it is empty.</p>
				
				
			<p>&nbsp;</p>
				<table class="auto-style2">
					<caption><a name="Fig.1"></a>Fig.1: The Drawing</caption>
					<tr>
						<td align="center"><strong>Sheet 1</strong></td>
						<td align="center"><strong>Sheet 2</strong></td>
					</tr>
					<tr>
						<td><img alt="" height="400" src="images/CAAScd2dlUcImpDraTo2DLayPicture1.png" width="650"/></td>
						<td><img alt="" height="250" src="images/CAAScd2dlUcImpDraTo2DLayPicture2.png" width="650" class="auto-style1"/></td>
					</tr>
				</table>
				<p>&nbsp;</p>
				<table class="auto-style2">
					<caption><a name="Fig.2"></a>Fig.2: The generated 2D Layout</caption>
					<tr>
						<td align="center"><strong>Sheet 1</strong></td>
						<td align="center"><strong>Sheet 2</strong></td>
					</tr>
					<tr>
						<td><img alt="" height="400" src="images/CAAScd2dlUcImpDraTo2DLayPicture3.png" width="650"/></td>
						<td><img alt="" height="250" src="images/CAAScd2dlUcImpDraTo2DLayPicture4.png" width="650" class="auto-style1"/></td>
					</tr>
				</table>
				<p>&nbsp;</p>
				<table class="auto-style2">
					<caption><a name="Fig.3"></a>Fig.3: The generated Part</caption>
					<tr>
						<td><img alt="" height="400" src="images/CAAScd2dlUcImpDraTo2DLayPicture5.png" width="650"/></td>
					</tr>
				</table>
			
			</li>
		</ol>
		</td>
	</tr>
</table>
<script type="text/javascript">insertLinkToTop()</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<script type="text/javascript">insertCopyright();</script>

</body>

</html>

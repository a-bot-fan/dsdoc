<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
<meta http-equiv="Content-Language" content="en-us" />
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<meta name="topictype" content="Uc" />
<meta name="devlang" content="idl" />
<meta name="devlang" content="idl" />
<link rel="stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css"/>
<script type="text/javascript" src="../CAADocJavaScript/DSDocTocToc.js">/* */</script>
<script type="text/javascript" src="../CAADocJavaScript/DSDocHighlight.js">/* */</script>
<script type="text/javascript" src="../CAADocJavaScript/submit.js">/* */</script>
<title>Creating and Modifying Simulation Material Domain</title>
</head>

<body onload="highlightSearchTerms();">

<table class="table1">
	<tr>
		<td class="DocHeader1">
			<h1>Creating and Modifying Simulation Material Domain</h1>
		</td>
	</tr>
	<tr>
		<td class="DocHeader3" style="width: 1807px">
		<table class="DocHeaderIntro">
			<tr>
				<td class="Intro1">
					<p class="header">This use case primarily focuses on the 
					methodology to create or modify a simulation material domain.</p>
					<hr class="header" />
				</td>
			</tr>
			<tr>
				<td class="Intro2"><span class="run-in">Before you begin:</span> 
					<ul>
						<li>Launch CATIA and then import and 
						open the
						<code>CAAScdFeaPumpModel.3dxml</code> file supplied in 
						the folder <code>InstallRootFolder\CAADoc\Doc\English\CAAScdFeaScenario\samples\</code> 
						where <code>InstallRootFolder</code> is the folder where 
						the API CD-ROM is installed.</li>
					</ul>
					<p><span class="run-in">Where to find the macro: 						
					<a href="CAAScdFeaSimulationMaterialDomainSource.htm">
					CAAScdFeaSimulationMaterialDomainSource.htm</a></span></p>
				</td>
			</tr>
		</table>
		</td>
	</tr>
</table>
<table class="indented">
	<tr>
		<td>
		<p>This use case can be divided in six steps:</p>
		<ol>
			<li><a href="#Step1">Retrieving the active product</a></li>
			<li><a href="#Step2">Creating Material</a></li>
			<li><a href="#Step3">Creating Simulation domain</a></li>
			<li><a href="#Step4">Creating material option and assign data</a></li>
			<li><a href="#Step5">Creating Behavior and add options in behavior</a></li>
			<li><a href="#Step6">Assigning material to part</a></li>			
		</ol>
		</td>
	</tr>
</table>
<table class="table1">
	<tr>
		<td>
		<ol class="task">
			<li>
			<p><strong><a name="Step1"></a>Retrieving the active product</strong></p>
			<p>As a first step, the UC retrieves the active product. </p>
<pre class="code">... 
<span class="keyword">Dim </span>myEditor<span class="keyword"> As </span>Editor
<span class="keyword">Set </span>myEditor = CATIA.ActiveEditor

<span class="keyword">Dim </span>myProdService<span class="keyword"> As </span>PLMProductService
<span class="keyword">Set </span>myProdService = myEditor.GetService(&quot;PLMProductService&quot;)

<span class="keyword">Dim </span>myEntities<span class="keyword"> As </span>PLMEntities
<span class="keyword">Set </span>myEntities = myProdService.EditedContent

<span class="keyword">Dim </span>myRootProduct<span class="keyword"> As </span>VPMReference
<span class="keyword">Set </span>myRootProduct = myEntities.Item(1)
...
</pre>
			</li>
			<li>
			<p><strong><a name="Step2"></a>Creating Material</strong></p>
			<p>In this step UC creates a material reference.</p>
<pre class="code">...
<span class="keyword">Dim </span>myMaterialService<span class="keyword"> As </span>MATPLMService
<span class="keyword">Set </span>myMaterialService = CATIA.GetSessionService(&quot;MATPLMService&quot;)
	
<span class="keyword">Dim </span>myCoreMatRef <span class="keyword"> As </span>Material
<span class="keyword">Dim </span>myMaterialEditor<span class="keyword"> As </span>Editor
myMaterialService.PLMCreate &quot;dsc_matref_ref_Core&quot;, myCoreMatRef, myMaterialEditor
...
</pre>
			</li>
			<li>
			<p><strong><a name="Step3"></a>Creating Simulation domain</strong></p>
			<p>In this step UC creates simulation domain in the material.</p>
<pre class="code">...
<span class="keyword">Dim </span>myDomainList<span class="keyword"> As </span>MaterialDomains
myCoreMatRef.GetDomains myDomainList
	
<span class="keyword">Dim </span>myDomain<span class="keyword"> As </span>MaterialDomain
myDomainList.Add &quot;dsc_matref_rep_SmaOptions&quot;, myDomain

<span class="keyword">Dim </span>mySimDomain<span class="keyword"> As </span>SimMaterialDomain
<span class="keyword">Set </span>mySimDomain = myDomain.MaterialDomainContent
...
</pre>			
			</li>
			<li>
				<p><strong><a name="Step4"></a>Creating material options and assign data</strong></p>
				<p>In this step UC creates new density and elasticity material options.</p>
			
				<pre class="code">...
<span class="keyword">Dim</span> myMaterialOptions <span class="keyword">As</span> SimMaterialOptions
<span class="keyword">Set</span> myMaterialOptions = MySimDomain.Options

<span class="comment">' Creation of a density material option</span>

<span class="keyword">Dim</span> myDensity <span class="keyword">As</span> SimDensity
<span class="keyword">Set</span> myDensity = myMaterialOptions.Add(&quot;SimDensity&quot;)

<span class="keyword">Dim</span> myDensityColumn <span class="keyword">As</span> SimTableColumn
<span class="keyword">Set</span> myDensityColumn = myDensity.GetMaterialTableColumn(SimDensityDensity)
myDensityColumn.SetCellData 1, 7870

<span class="comment">' Creation of an elasticity material option</span>

<span class="keyword">Dim</span> myElastic <span class="keyword">As</span> SimElastic
<span class="keyword">Set</span> myElastic = myMaterialOptions.Add(&quot;SimElasticity&quot;)

myElastic.ElasticType = SimElasticIsotropic
myElastic.ModuliTimeScaletype = SimElasticLongTerm

<span class="keyword">Dim</span> myYoungsModulusColumn <span class="keyword">As</span> SimTableColumn
<span class="keyword">Set</span> myYoungsModulusColumn = myElastic.GetMaterialTableColumn(SimElasticYoungsModulus)
myYoungsModulusColumn.SetCellData 1, 211000000000.0

<span class="keyword">Dim</span> myPoissonsRatioColumn <span class="keyword">As</span> SimTableColumn
<span class="keyword">Set</span> myPoissonsRatioColumn = myElastic.GetMaterialTableColumn(SimElasticPoissonsRatio)
myPoissonsRatioColumn.SetCellData 1, 0.291
...
				</pre>
				<p>You can find the available late types for material options creation in the <a href="CAAScdFeaMaterialLateTypes.htm">
					Creation Late Types for Material Features</a> article.
				</p>
			</li>
			<li>
			<p><strong><a name="Step5"></a>Creating Behavior and add options in behavior</strong></p>
			<p>In this step UC creates a material behavior and add options in it. </p>
<pre class="code">...
<span class="keyword">Dim</span> myBehaviors <span class="keyword">As</span> SimMaterialBehaviors
<span class="keyword">Set</span> myBehaviors = mySimDomain.Behaviors

<span class="keyword">Dim</span> myBehavior <span class="keyword">As</span> MaterialBehavior
<span class="keyword">Set</span> myBehavior = myBehaviors.Add

<span class="keyword">Dim</span> myBehaviorOptions <span class="keyword">As</span> MaterialBehaviorOptions
<span class="keyword">Set</span> myBehaviorOptions = myBehavior.BehaviorOptions

myBehaviorOptions.Add myDensity, 1
myBehaviorOptions.Add myElastic, 2
...
</pre>
			</li>
			<li>
			<p><strong><a name="Step6"></a>Assigning material to part</strong></p>
			<p>In this step UC assigns the created material to a part.</p>
<pre class="code">...
<span class="comment">' Retrieve the Root Occurrence and the Part Instance</span>

<span class="keyword">Dim</span> myRootOccurrence <span class="keyword">As</span> VPMRootOccurrence
<span class="keyword">Set</span> myRootOccurrence = myProdService.RootOccurrence

<span class="keyword">Dim</span> myInstances <span class="keyword">As</span> VPMInstances
<span class="keyword">Set</span> myInstances = myRootProduct.Instances

<span class="keyword">Dim</span> myInstance <span class="keyword">As</span> VPMInstance
<span class="keyword">Set</span> myInstance = myInstances.Item(1)

<span class="keyword">Dim</span> myInstanceRef <span class="keyword">As</span> VPMReference
<span class="keyword">Set</span> myInstanceRef = myInstance.ReferenceInstanceOf

<span class="keyword">Dim</span> myRepInstances <span class="keyword">As</span> VPMRepInstances
<span class="keyword">Set</span> myRepInstances = myInstanceRef.RepInstances

<span class="keyword">Dim</span> myPartRepInstance <span class="keyword">As</span> VPMRepInstance
<span class="keyword">Set</span> myPartRepInstance = myRepInstances.Item(1)

<span class="comment">' Creating link to the part instance</span>

<span class="keyword">Dim</span> myLinkToPartInstance <span class="keyword">As</span> AnyObject
<span class="keyword">Set</span> myLinkToPartInstance = myProdService.ComposeLink(myRootOccurrence, myPartRepInstance, Nothing)

<span class="comment">' Assigning material</span>

<span class="keyword">Dim</span> myCoreAppliedMaterial <span class="keyword">As</span> AppliedMaterial
myMaterialService.SetMaterialCore myLinkToPartInstance, myCoreMatRef, myCoreAppliedMaterial
...
</pre>
			</li>			
	</ol>
	</td>
	</tr>
</table>	

<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<script type="text/javascript">insertCopyright();</script>

</body>

</html>

<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta content="en-us" http-equiv="Content-Language" />
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type" />
<meta content="Uc" name="topictype" />
<meta content="idl" name="devlang" />
<meta content="idl" name="devlang" />
<link href="../CAADocStyleSheets/caav5.css" rel="stylesheet" type="text/css"/>
<script src="../CAADocJavaScript/DSDocTocToc.js" type="text/javascript">/* */</script>
<script src="../CAADocJavaScript/DSDocHighlight.js" type="text/javascript">/* */</script>
<script src="../CAADocJavaScript/submit.js" type="text/javascript">/* */</script>
<title>Opening a Simulation Document</title>
</head>

<body onload="highlightSearchTerms();">

<table class="table1">
	<tr>
		<td class="DocHeader1">
		<h1>Opening a Simulation Document</h1>
		</td>
	</tr>
	<tr>
		<td class="DocHeader3">
		<table class="DocHeaderIntro">
			<tr>
				<td class="Intro1">
				<p class="header">This article explains how to open the .3dxml or 
				SIM file and retrieve the results analysis case. This can be used 
				to create and manage the results features.</p>
				<hr class="header" /></td>
			</tr>
			<tr>
				<td class="Intro2"><span class="run-in">Before you begin:</span> 
				Note that:
				<ul>
					<li><strong>Opening .3dxml file:</strong> You should first launch 
					CATIA and then import the <code>CAAScdFeaResults.3dxml</code> 
					file supplied in the folder <code>InstallRootFolder\CAADoc\Doc\English\CAAScdFeaResults\samples\</code> 
					where <code>InstallRootFolder</code> is the folder where the 
					API CD-ROM is installed.</li>
					<li><strong>Opening SIM file:</strong> You should first launch 
					CATIA. Then open the Physics Results app. Rename the <code>CAAScdFeaSimResults.3dxml</code> 
					file supplied in the folder <code>InstallRootFolder\CAADoc\Doc\English\CAAScdFeaResults\samples\</code> 
					where <code>InstallRootFolder</code> is the folder where the 
					API CD-ROM is installed to <code>CAAScdFeaSimResults.SMASim</code>. 
					Then import this file.</li>
				</ul>
				</td>
			</tr>
		</table>
		</td>
	</tr>
</table>
<table class="indented">
	<tr>
		<td>
		<p>This use case can be divided in two steps:</p>
		<ol>
			<li><a href="#Step1">Retrieving the Sim Results Manager</a></li>
			<li><a href="#Step2">Retrieving the Results Analysis Case</a></li>
		</ol>
		</td>
	</tr>
</table>
<table class="table1">
	<tr>
		<td>
		<ol class="task">
			<li>
			<p><strong><a name="Step1"></a>Retrieving the Sim Results Manager</strong></p>
			<p>As a first step, the below code retrieves editor, the simulation 
			reference, the simulation results rep and the sim results manager.
			</p>
			<pre class="code">... 

<span class="keyword">Dim </span>oEditor<span class="keyword"> As </span>Editor
<span class="keyword">Set </span>oEditor = CATIA.ActiveEditor

<span class="keyword">Dim </span>oSimulationReference<span class="keyword"> As </span>SimulationReference
    
<span class="keyword">Dim </span>oProdService<span class="keyword"> As </span>PLMProductService
<span class="keyword">Set </span>oProdService = oSimEditor.GetService("PLMProductService")

<span class="keyword">Dim </span>oEntities<span class="keyword"> As </span>PLMEntities

<span class="keyword">If Not </span>oProdService.EditedContent<span class="keyword"> Is Nothing Then</span>
    
<span class="keyword">Set </span>oEntities = oProdService.EditedContent

<span class="keyword">Dim </span>oEntity<span class="keyword"> As </span>PLMEntity
<span class="keyword">Dim </span>oSimObjEntity<span class="keyword"> As </span>PLMEntity
    
<span class="keyword">For </span>Each oEntity<span class="keyword"> In </span>oEntities
    <span class="keyword">If </span>oEntity.GetCustomType = "SIMObjSimulationObjectGenericDS" Or oEntity.GetCustomType = "DesignSight"<span class="keyword"> Then </span>
        <span class="keyword">Set </span>oSimObjEntity = oEntity
    <span class="keyword">End If</span>
<span class="keyword">Next</span>
    
oSimulationReference = oSimObjEntity

<span class="keyword">Dim </span>oSimResults<span class="keyword"> As </span>SimulationResults
<span class="keyword">Set </span>oSimResults = oSimulationReference.Results

<span class="keyword">Dim </span>oSimRepresentation<span class="keyword"> As </span>SimulationRepresentation
<span class="keyword">Set </span>oSimRepresentation = oSimResults.Item(1)
    
<span class="keyword">Dim </span>oSimRepManager<span class="keyword"> As </span>SimResultRepManager
<span class="keyword">Set </span>oSimRepManager = oSimRepresentation.Root
    
<span class="keyword">Dim </span>oResultsManager<span class="keyword"> As </span>SimResultsManager
<span class="keyword">Set </span>oResultsManager = oSimRepManager.GetItem("SimResultsManager")

...
</pre>
			</li>
			<li>
			<p><strong><a name="Step2"></a>Retrieving the Results Analysis Case</strong></p>
			<p>As a first step, the below code retrieves the analysis case from 
			results manager. </p>
			<pre class="code">...
<span class="keyword">Dim </span>oResultsAnalysisCases<span class="keyword"> As </span>SimResultsAnalysisCases
<span class="keyword">Set </span>oResultsAnalysisCases = oResultsManager.ResultsAnalysisCases

<span class="keyword">Dim </span>oResultsAnalysisCase<span class="keyword"> As </span>SimResultsAnalysisCase
<span class="keyword">Set </span>oResultsAnalysisCase = oResultsAnalysisCases.Item(1)

...
</pre>
			</li>
		</ol>
		</td>
	</tr>
</table>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<script type="text/javascript">insertCopyright();</script>

</body>

</html>

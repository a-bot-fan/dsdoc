<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
	<meta http-equiv="Content-Language" content="en-us" />
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
	<meta name="topictype" content="Uc" />
	<meta name="devlang" content="idl" />
	<link rel="stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css"/>
	<script type="text/javascript" src="../CAADocJavaScript/DSDocTocToc.js">/* */</script>
	<script type="text/javascript" src="../CAADocJavaScript/DSDocHighlight.js">/* */</script>
	<script type="text/javascript" src="../CAADocJavaScript/submit.js">/* */</script>
	
	<title>Managing Connection Property Features</title>
</head>

<body onload="highlightSearchTerms();">

<table class="table1">
	<tr>
		<td class="DocHeader1">
			<h1>Managing Connection Property Features</h1>
		</td>
	</tr>
	<tr>
		<td class="DocHeader3">
		<table class="DocHeaderIntro">
			<tr>
				<td class="Intro1">
					<p class="header">This use case primarily focuses on the methodology 
					to include and exclude connection property into the FEM representation.</p>
					<hr class="header" />
				</td>
			</tr>
			<tr>
				<td class="Intro2"><span class="run-in">Before you begin:</span> 
					<ul>
						<li>
							Launch CATIA and then import and open the
							<code>CAAScdFeaPumpModel.3dxml</code> file supplied 
							in the folder <code>
						InstallRootFolder\CAADoc\Doc\English\CAAScdFeaScenario\samples\</code> 
							where <code>InstallRootFolder</code> is the folder 
						where the API CD-ROM is installed.
						</li>
            <li>Note: Creation of new PLM objects via scripting, as in this 
                use case, requires an enabling license in addition to the
                interactive Roles needed to access the functionality.</li>                        
					</ul>
					<p><span class="run-in">Where to find the macro:
					<a href="CAAScdFeaManagingConnectionPropertySource.htm">
					CAAScdFeaManagingConnectionPropertySource.htm</a></span></p>
				</td>
			</tr>
		</table>
		</td>
	</tr>
</table>
<table class="indented">
	<tr>
		<td>
		<p>This use case can be divided in seven steps:</p>
		<ol>
			<li><a href="#Step1">Retrieving the active product</a></li>
			<li><a href="#Step2">Creating the FEM representation and retrieving its root object</a></li>
			<li><a href="#Step3">Creating and including a connection property</a></li>
			<li><a href="#Step4">Checking the connection property inclusion</a></li>
			<li><a href="#Step5">Updating the FEM representation</a></li>
			<li><a href="#Step6">Excluding the connection property</a></li>
			<li><a href="#Step7">Including the connection property again</a></li>
		</ol>
		</td>
	</tr>
</table>
<table class="table1">
	<tr>
		<td>
		<ol class="task">
			<li>
				<p><strong><a name="Step1"></a>Retrieving the active product</strong></p>
				<p>As a first step, the UC retrieves the active product. </p>
<pre class="code">... 
<span class="keyword">Dim </span>myEditor<span class="keyword"> As </span>Editor
<span class="keyword">Set </span>myEditor = CATIA.ActiveEditor

<span class="keyword">Dim </span>myProdService<span class="keyword"> As </span>PLMProductService
<span class="keyword">Set </span>myProdService = myEditor.GetService("PLMProductService")

<span class="keyword">Dim </span>myEntities<span class="keyword"> As </span>PLMEntities
<span class="keyword">Set </span>myEntities = myProdService.EditedContent

<span class="keyword">Dim </span>myRootProduct<span class="keyword"> As </span>VPMReference
<span class="keyword">Set </span>myRootProduct = myEntities.Item(1)
...</pre>
			</li>
			<li>
				<p><strong><a name="Step2"></a>Creating the FEM representation and retrieving its root object</strong></p>
				<p>In this step UC creates a new FEM representation object. To 
				perform the creation, a simulation representation factory have to be 
				retrieved on the reference object on which the FEM rep will be 
				aggregated.</p>
<pre class="code">...
<span class="keyword">Dim</span> myPrdRepFactory <span class="keyword">As</span> SimPrdRepFactory
<span class="keyword">Set</span> myPrdRepFactory = myRootProduct.GetItem(&quot;SimPrdRepFactory&quot;)

<span class="keyword">Dim</span> myFemRepRef <span class="keyword">As</span> VPMRepReference
<span class="keyword">Set</span> myFemRepRef = myPrdRepFactory.CreatePrdRep(&quot;FEM&quot;)

<span class="keyword">Dim</span> myFemRepRoot <span class="keyword">As</span> SimFemRoot
<span class="keyword">Set</span> myFemRepRoot = myFemRepRef.GetItem(&quot;SimFemRoot&quot;)
...
</pre>
			</li>
			<li>
				<p><strong><a name="Step3"></a>Creating connection property</strong></p>
				<p>In this step UC creates connection property and includes it in the FEM representation upon addition.</p>
				<p>For further information about creating a connection property refer to the spring connection property
				section of the article <a href="CAAScdFeaConnections.htm">Creating a Connection Property</a>.
				</p>
			</li>
			<li>
				<p><strong><a name="Step4"></a>Checking the connection property inclusion</strong></p>
				<p>In this step UC checks whether the connection property is included or not.</p>
<pre class="code">...
myFemRepRoot.IsIncludedPropertyConnection myRootOccurrence, mySpringConnection <span class="comment">' Connection property is created upon addition</span>
...
</pre>
			</li>
			<li>
				<p><strong><a name="Step5"></a>Updating the FEM representation</strong></p>
				<p>In this step UC updates the FEM representation with the previously included connection property.</p>
<pre class="code">...
myFemRepRoot.Update
...
</pre>
			</li>
			<li>
				<p><strong><a name="Step6"></a>Excluding the connection property</strong></p>
				<p>In this step UC excludes the connection property from the FEM representation.</p>
<pre class="code">...
myFemRepRoot.ExcludePropertyConnection myRootOccurrence, mySpringConnection
...
</pre>
			</li>
			<li>
				<p><strong><a name="Step7"></a>Including the connection property again</strong></p>
				<p>In this step UC includes the connection property in the FEM representation again.</p>
<pre class="code">...
myFemRepRoot.IncludePropertyConnection myRootOccurrence, mySpringConnection
...
</pre>
			</li>
		</ol>
		</td>
	</tr>
</table>	

<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<script type="text/javascript">insertCopyright();</script>

</body>

</html>

<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta content="en-us" http-equiv="Content-Language" />
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type" />
<meta content="Uc" name="topictype" />
<meta content="idl" name="devlang" />
<meta content="idl" name="devlang" />
<link href="../CAADocStyleSheets/caav5.css" rel="stylesheet" type="text/css"/>
<script src="../CAADocJavaScript/DSDocTocToc.js" type="text/javascript">/* */</script>
<script src="../CAADocJavaScript/DSDocHighlight.js" type="text/javascript">/* */</script>
<script src="../CAADocJavaScript/submit.js" type="text/javascript">/* */</script>
<title>Displaying Inertia Data</title>
</head>

<body onload="highlightSearchTerms();">

<table class="table1">
	<tr>
		<td class="DocHeader3">
		<table>
			<tr>
				<td class="DocHeader1" colspan="2" style="height: 10px">
				<h1>Displaying Inertia Data</h1>
				</td>
			</tr>
			<tr>
				<td class="DocHeader4" colspan="2">&nbsp;</td>
			</tr>
			<tr>
				<td class="DocHeader3">
				<table class="DocHeaderIntro">
					<tr>
						<td class="Intro1">
						<p class="header"><a name="hj-top"></a>This use case primarily 
						focuses on the methodology to Generate Attribute Links Extracted 
						from 3D Part Pointed by a Generative View in a Drawing Table</p>
						<hr class="header" /></td>
					</tr>
					<tr>
						<td class="Intro2"><span class="run-in">Before you begin</span>:
						<ul>
							<li>You should first launch CATIA.</li>
							<li>Import as reference the CAAScdVPMUcInertia.3dxml file 
								from the folder InstallRootFolder\CAADoc\Doc\English\CAAScdVPMDigitalReview 
								where InstallRootFolder is the folder where the 
								API CD-ROM is installed.</li>
							<li>In the Navigation Experience tab, right click Root_product 
								A.1, and click Open.</li>
							<li>In the Root_product A.1 tab, select Root_product 
								A.1 in the tree.<br />
								Note that you can also select the 3D part instance 
								(3DPart A.1), the part body (PartBody), or the pad 
								feature (Pad.1)</li>
							<li>Launch the following macro:</li>
						</ul>
						<p><span class="run-in">Where to find the macro</span>:</p>
						<ul>
						<li>Display: <a href="CAAScdVPMUcInertiaSource.htm">CAAScdVPMUcInertiaSource.htm</a></li>
						<li>Run: CAAScdVPMUcInertia.CATScript in InstallRootFolder\CAADoc\Doc\English\CAAScdVPMDigitalReview.
						Refer to <a href="../CAAScdInfInfrastructure/CAAInfLaunchingVBUseCase.htm">Launching an Automation Use Case</a>.</li>
						</ul>
						</td>
					</tr>
				</table>
				</td>
				<td class="DocHeader2">
				<table class="DocTopics">
					<tr>
						<td class="TopicsTitle">Related Topics</td>
					</tr>
					<tr>
						<td><a href="CAAScdTocVPMDigitalReview.htm">Digital Review 
						Object Model Map</a></td>
					</tr>
				</table>
				</td>
			</tr>
		</table>
		</td>
	</tr>
</table>
<table>
	<caption><a name="Fig.1"></a>Fig.1: The Part to Analyze</caption>
	<tr>
		<td>
		<img alt="Part" height="661" src="CAAScdVPMUcInertia01.png" width="671"/></td>
	</tr>
</table>
<table>
	<tr>
		<td>
		<p>This use case can be divided in three steps:</p>
		<ol>
			<li><a href="#Step1">Retrieving the Inertia Object</a></li>
			<li><a href="#Step2">Computing the Inertia Data</a></li>
			<li><a href="#Step3">Displaying the Inertia Data</a></li>
		</ol>
		</td>
	</tr>
</table>
<table class="table1">
	<tr>
		<td>
		<ol class="task">
			<li>
				<p><a name="Step1"></a><strong>Retrieving the Inertia Objects</strong></p>
				<p>First, the macro retrieves the active editor and the selection.</p>
				<pre class="code">
<span class="keyword">Dim</span> theEditor <span class="keyword">As</span> Editor
<span class="keyword">Set</span> theEditor = CATIA.ActiveEditor.ActiveEditor

<span class="keyword">Dim</span> theSelection <span class="keyword">As</span> Selection
<span class="keyword">Set</span> theSelection = theEditor.Selection
...</pre>
				<p>Then, it retrieves the selected object from the selection.</p>
				<pre class="code">...
<span class="keyword">If</span> theSelection.Count2 &lt;&gt; 0 <span class="keyword">Then</span> 
  <span class="keyword">Dim</span> theElement <span class="keyword">As</span> AnyObject
  <span class="keyword">Set</span> theElement = theSelection.Item2(1).Value
  ...</pre>
				<p>It retrieves the inertia services from the editor.</p>
				<pre class="code">   ...
  <span class="keyword">Dim</span> theInertiaService <span class="keyword">As</span> InertiaService
  <span class="keyword">Set</span> theInertiaService = theEditor.GetService("InertiaService") 
  <span class="keyword">Dim</span> theInertiaBoxService <span class="keyword">As</span> InertiaBoxService
  <span class="keyword">Set</span> theInertiaBoxService = theEditor.GetService("InertiaBoxService") 
  ...				</pre>
				<p>It retrieves the inertia and the inertia box from the inertia 
				services.</p>
				<pre class="code">   ...
  <span class="keyword">Dim</span> theInertiaElement <span class="keyword">As</span> Inertia
  <span class="keyword">Set</span> theInertiaElement = theInertiaService.GetInertiaElement(theElement) 
  <span class="keyword">Dim</span> theInertiaBoxElement <span class="keyword">As</span> InertiaBox
  <span class="keyword">Set</span> theInertiaBoxElement = theInertiaBoxService.GetInertiaBoxElement(theElement) 
  ...</pre>
			</li>
			<li>
				<p><a name="Step2"></a><strong>Computing the Inertia Data</strong></p>
				<p>First, the macro requests to compute the inertia data from the 
				main body only.</p>
				<pre class="code">   ...
  theInertiaElement.OnlyMainBody
  ...</pre>
				<p>Then it computes the area, the volume, the mass, and the coordnates 
				of the center of gravity.</p>
				<pre class="code">   ...
  <span class="keyword">Dim</span> theArea <span class="keyword">As</span> Double
  theArea = theInertiaElement.GetArea 

  <span class="keyword">Dim</span> theVolume <span class="keyword">As</span> Double
  theVolume = theInertiaElement.GetVolume

  <span class="keyword">Dim</span> theMass <span class="keyword">As</span> Double
  theMass = theInertiaElement.GetMass

  <span class="keyword">Dim</span> theCOG(2) <span class="keyword">As</span> Double
  theInertiaElement.GetCOGPosition theCOG(0), theCOG(1), theCOG(2) 
  ...</pre>
				<p>It computes the inertia matrix, the inertia principle axes, and 
				the inertia moments.</p>
				<pre class="code">   ...
  <span class="keyword">Dim</span> theMatrix(8) <span class="keyword">As</span> Double
  theArea = theInertiaElement.GetInertiaMatrix theMatrix

  <span class="keyword">Dim</span> theAxes(8) <span class="keyword">As</span> Double
  theAxes = theInertiaElement.GetPrincipalAxes theAxes

  <span class="keyword">Dim</span> theMoments(2) <span class="keyword">As</span> Double
  theMoments = theInertiaElement.GetPrincipalMoments theMoments
  ...</pre>
				<p>It then computes the bounding box, that is the coordinates of 
				bounding box origin and the lenghes of its sides.</p>
				<pre class="code">   ...
  <span class="keyword">Dim</span> theBoundingBoxOrigin(2) <span class="keyword">As</span> Double
  <span class="keyword">Dim</span> theBoundingBoxLengths(2) <span class="keyword">As</span> Double
  theInertiaBoxElement.GetBoundingBox theBoundingBoxOrigin, theBoundingBoxLengths
  ...</pre>
			</li>
			<li>
				<p><a name="Step3"></a><strong>Displaying the Inertia Data</strong></p>
				<p>The macro uses the computed inertia data to display it in 
				a message box.</p>
				<table>
					<caption><a name="Fig.2"></a>Fig.2: The Inertia Data</caption>
					<tr>
						<td>
						<img alt="Inertia Data" height="484" src="CAAScdVPMUcInertia02.png" width="392"/></td>
					</tr>
				</table>
			</li>
		</ol>
		<h2><a name="InShort"></a>In Short</h2>
		<p>This use case shows how to retrieve the <strong>InertiaService</strong> 
		and <strong>InertiaBoxService</strong> objects from the active <strong>
		Editor</strong> object. Then it shows you how to retrieve the <strong>
		Inertia</strong> and <strong>InertiaBox</strong> objects from these 
		service objects. Finally it shows you how to compute the inertia data 
		and the bounding box of the part selected.</p>
		</td>
	</tr>
</table>
<script type="text/javascript">insertLinkToTop()</script>
<!-- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-comment-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= -->
<script type="text/javascript">insertCopyright();</script>

</body>

</html>
